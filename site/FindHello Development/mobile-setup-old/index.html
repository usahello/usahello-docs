<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://docs.usahello.org/FindHello%20Development/mobile-setup-old/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Mobile Setup - USAHello Docs</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Mobile Setup";
        var mkdocs_page_input_path = "FindHello Development/mobile-setup-old.md";
        var mkdocs_page_url = "/FindHello%20Development/mobile-setup-old/";
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> USAHello Docs
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../documentation-setup/">Documentation setup</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">FindHello Development</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../api-setup/">API setup</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../app-setup/">App setup</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../mobile-setup/">Mobile setup</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../solr-setup/">Solr setup</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">FindHello Deployment</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../FindHello%20Deployment/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../FindHello%20Deployment/server-setup/">Server setup</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../FindHello%20Deployment/web-deploy/">Web app deployment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../FindHello%20Deployment/mobile-deploy/">Mobile app deployment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../FindHello%20Deployment/solr-setup/">Solr setup</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">FindHello Other</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../FindHello%20Other/analytics/">Analytics</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../FindHello%20Other/arabic-translations/">Arabic Translations</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../FindHello%20Other/search/">Search</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">USAHello Docs</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" alt="Docs"></a> &raquo;</li><li>Mobile Setup</li>
    <li class="wy-breadcrumbs-aside">
        <a href="https://github.com/usahello/usahello-docs/edit/master/docs/FindHello Development/mobile-setup-old.md"
          class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>

          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="mobile-setup">Mobile Setup</h1>
<p>To build the Ionic app for iOS and Android you have to have a number of dependencies installed and these can be difficult to configure correctly.</p>
<p>At a high level we will be using the Ionic CLIs <code>cordova</code> command to build test and release versions of the iOS and Android app. For example:</p>
<pre><code class="language-sh">&gt; ionic cordova build android --prod --release
</code></pre>
<p>You can use this command to create builds for development testing or production, to run the app locally on a connected phone or to run on either the Android or iOS emulator.</p>
<p>The following instructions are for MacOS.</p>
<h2 id="cordova">Cordova</h2>
<p>First, make sure Cordova is installed:</p>
<pre><code class="language-sh">npm install -g cordova
</code></pre>
<h2 id="android">Android</h2>
<p>Instead of installing the entire Android studio we're going to install the SDK separately which gives us the tools required to build the app without the need for the entire editor. It it easier to configure and use the SDK outside of Android Studio. We need to also install the Java SDK and runtime as well as some Java build tools (primarily gradle) that Cordova will use to build the app. </p>
<h3 id="java-8-sdk">Java 8 SDK</h3>
<p>The first thing to install is the Java 8 JDK and runtime. For MacOS go to:</p>
<p>https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html</p>
<p>and download for Mac OS X x64 ("Java SE Development Kit 8u191")</p>
<h3 id="android-build-tools">Android build tools</h3>
<p>These are tools used by Cordova to build the Android app. Install the following with <code>brew</code>:</p>
<pre><code class="language-bash">brew install gradle ant maven
</code></pre>
<p>and add these configuration variables to your shell:</p>
<pre><code class="language-sh">vim ~/.bashrc
</code></pre>
<p>add:</p>
<pre><code class="language-sh"># Android build tools
export GRADLE_HOME=/usr/local/opt/gradle
export ANT_HOME=/usr/local/opt/ant
export MAVEN_HOME=/usr/local/opt/maven

...
</code></pre>
<h3 id="android-sdk">Android SDK</h3>
<p>Now install the SDK:</p>
<pre><code class="language-sh">brew tap homebrew/cask
brew cask install android-sdk
</code></pre>
<p>Then need to now add the SDK to your path so that Cordova can find it:</p>
<pre><code class="language-sh">vim ~/.bashrc
</code></pre>
<p>add</p>
<pre><code class="language-sh"># Android SDK
export ANDROID_HOME=/usr/local/share/android-sdk
export PATH=$PATH:$ANDROID_HOME/emulator
export PATH=$PATH:$ANDROID_HOME/tools
export PATH=$PATH:$ANDROID_HOME/platform-tools
export PATH=$PATH:$ANDROID_HOME/bin

...
</code></pre>
<p>(Note that it's important to place the <code>emulator</code> folder above the <code>tools</code> folder to avoid problems later with emulators)</p>
<h4 id="troubleshooting-issue-with-emulator-paths">Troubleshooting: Issue with emulator paths</h4>
<p>When installing the <code>android-sdk</code> it looks like it automatically symlinks a lot of the tools from the brew directory to <code>/usr/local/bin</code>. </p>
<p>You can see this with:</p>
<pre><code class="language-sh">ls -la /usr/local/bin | grep android
</code></pre>
<p>But we are already adding them to the path via our <code>.bashrc</code>.</p>
<p>There was an issue with the <code>emulator</code> command being linked from <code>/usr/local/Caskroom/android-sdk/4333796/tools/</code> instead of  <code>/usr/local/Caskroom/android-sdk/4333796/emulators/</code></p>
<p>The easiest thing is to just delete the symlinks and allow our path changes to sort the issue:</p>
<pre><code class="language-sh">cd /usr/local/bin
rm -rf android archquery avdmanager emulator emulator-check jobb lint mksdcard monitor monkeyrunner screenshot2 sdkmanager uiautomatorviewer
</code></pre>
<h3 id="android-target-platform">Android target platform</h3>
<p>We now need to install an Android target platform using the Android SDK:</p>
<pre><code class="language-sh">sdkmanager &quot;platform-tools&quot; &quot;platforms;android-26&quot;
sdkmanager &quot;build-tools;26.0.1&quot;
</code></pre>
<h3 id="cordova-platform">Cordova platform</h3>
<p>We can now tell Cordova to set up the Android platform in our project:</p>
<pre><code class="language-sh">ionic cordova platform add android
</code></pre>
<p>or to specify a particular version:</p>
<pre><code class="language-sh">ionic cordova platform add android@X.X.X
</code></pre>
<p>Bear in mind that this is the <code>cordova-android</code> version, <strong>not the android version</strong>. You can see more here:</p>
<p>https://cordova.apache.org/docs/en/latest/guide/platforms/android/#requirements-and-support
https://stackoverflow.com/a/28678292/396300</p>
<h3 id="check-requirements">Check requirements</h3>
<p>At this point, doing the following should show that everything is in order for Android.</p>
<pre><code class="language-sh">ionic cordova requirements
</code></pre>
<ul>
<li>https://stackoverflow.com/a/41771566/396300</li>
</ul>
<h3 id="create-a-build">Create a build</h3>
<p>We should now be able to build the application for Android using:</p>
<pre><code class="language-sh">ionic cordova build android
</code></pre>
<p>This will create a new unsigned APK (the bundle that is created by the build and that can be run directly on an Android device)</p>
<h3 id="run-on-device">Run on device</h3>
<p>If you have an Android device connected to your laptop, you should be able to instruct Cordova to install and run the app automatically on the attached device using:</p>
<pre><code class="language-sh">ionic cordova android run
</code></pre>
<p>There is also a live-reload flag that in theory allows you to make changes and have them appear in real time:</p>
<pre><code class="language-sh">ionic cordova android run -lc
</code></pre>
<p>but it's not very reliable.</p>
<h4 id="environment-variables-when-running-on-device">Environment variables when running on device</h4>
<p>When running the app on a device (and have the API running on your machine), remember that you will have to update the <code>API_URL</code> in the <code>environment.ts</code> before running the build. You need to find the IP of the machine running the API on your local network and use this as the <code>API_URL</code>. You can use the <code>ifconfig</code> command for this. </p>
<h3 id="run-on-emulator">Run on Emulator</h3>
<p>You can also run the app on your machine via an emulator. First download a system image to use for emulation:</p>
<pre><code class="language-sh">sdkmanager &quot;system-images;android-26;google_apis;x86&quot;
</code></pre>
<p>Create a new device:</p>
<pre><code class="language-sh">avdmanager create avd -n test-device -k &quot;system-images;android-26;google_apis;x86&quot; -b x86 -c 100M -d 7 -f
</code></pre>
<p>And run it:</p>
<pre><code class="language-sh">emulator @test-device
</code></pre>
<p>https://stackoverflow.com/questions/43275238/how-to-set-system-images-path-when-creating-an-android-avd</p>
<p>You can then check what's installed:</p>
<pre><code class="language-sh">sdkmanager --list
</code></pre>
<p>You should now be able to run:</p>
<pre><code class="language-sh">ionic cordova emulate android
</code></pre>
<p>Again, there is also a live-reload flag that in theory allows you to make changes and have them appear in real time:</p>
<pre><code class="language-sh">ionic cordova android emulate  -lc
</code></pre>
<p>but it's not very reliable.</p>
<h4 id="emulator-environment-variables">Emulator environment variables</h4>
<p>When running the app on an emulator (and have the API running on your machine), remember that you will have to update the <code>API_URL</code> in the <code>environment.ts</code> before running the emulator. The value you should use is <code>10.0.2.2:8000/</code> which is the default IP for the emulator.</p>
<h3 id="debugging">Debugging</h3>
<p>To debug the native Android app, you can use Chrome's remote debugging tools to connect to the webview that is running within the app on either the emulator or the device. This allows you to get access to all of the regular dev-tools that you would otherwise use to debug the web app. </p>
<p>Here's a description of this process:</p>
<blockquote>
<p><a href="https://ionic.zone/debug/remote-debug-your-app">https://ionic.zone/debug/remote-debug-your-app</a></p>
</blockquote>
<h4 id="troubleshooting-issue-with-chrome-remote-debugging-tools">Troubleshooting: Issue with Chrome remote debugging tools</h4>
<p>Unfortunately I've noticed a problem running the remote dev tools from Chrome/Chromium that is apparently something to do with newer versions of the browser that are greater then release M63. You will notice that the dev-tools window is mostly blank and you can't use them.</p>
<p><strong>TLDR</strong> You need an old version of Chromium to use the remote debugger properly. Here's a link to a download:</p>
<ul>
<li>https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Mac/499098/</li>
</ul>
<p>Here is the issue discussed:</p>
<ul>
<li><a href="https://groups.google.com/forum/#!topic/google-chrome-developer-tools/qWg3OAGUIOY">https://groups.google.com/forum/#!topic/google-chrome-developer-tools/qWg3OAGUIOY</a></li>
</ul>
<p>If you need to download another version, first find the version you want (a version &lt; 63) by looking in tags in the repo e.g <code>62.0.3202.0</code>:</p>
<ul>
<li><a href="https://chromium.googlesource.com/chromium/src/">https://chromium.googlesource.com/chromium/src/</a></li>
</ul>
<p>or just Wikipedia:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Google_Chrome_version_history">https://en.wikipedia.org/wiki/Google_Chrome_version_history</a></li>
</ul>
<p>Now follow the guide at the bottom to get the version:</p>
<ul>
<li><a href="https://www.chromium.org/getting-involved/download-chromium">https://www.chromium.org/getting-involved/download-chromium</a></li>
</ul>
<p>First search the version here:</p>
<ul>
<li><a href="https://omahaproxy.appspot.com/">https://omahaproxy.appspot.com/</a></li>
</ul>
<p>Which will give you a </p>
<blockquote>
<p>Branch Base Position: 499098 </p>
</blockquote>
<p>Now look that up in the "filter box":</p>
<ul>
<li>https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Mac/499098/</li>
</ul>
<h4 id="sharing-build-for-testing">Sharing build for testing</h4>
<p>With Android, as long as your device is configured to run unsigned APKs, you can simply send someone the generated APK file in:</p>
<p><code>./platforms/android/app/build/outputs/apk/debug/app-debug.apk</code></p>
<p>The Google Play Console also has the ability to deploy test builds as part of your release strategy.</p>
<hr />
<h2 id="ios">iOS</h2>
<p>Getting the iOS platform set up is much easier than Android. First, you need to make sure you are on a Mac and have Xcode installed.</p>
<h3 id="command-line-tools">Command line tools</h3>
<p>You need to make sure you have Xcode's "command line tools" installed:</p>
<pre><code class="language-sh">xcode-select --install
</code></pre>
<h3 id="cordova-platform_1">Cordova platform</h3>
<p>We can now tell Cordova to set up the iOS platform in our project:</p>
<pre><code class="language-sh">ionic cordova platform add ios
</code></pre>
<h3 id="create-a-build_1">Create a build</h3>
<p>We should now be able to build the application for iOS using:</p>
<pre><code class="language-sh">ionic cordova ios build
</code></pre>
<p>Unlike Android, this doesn't create an APK or bundle that can be run directly on a device. Instead it generates
an Xcode project within the <code>./platforms/ios/</code> folder that we can now open with Xcode. </p>
<h3 id="running-and-emulating">Running and emulating</h3>
<p>Open the Xcode project at <code>./platforms/ios/FindHello.xcodeproj</code></p>
<p>This will allow you to run the application on an emulator from within Xcode, or select any physical device you have connected to your machine, and run the app on that. To do this, you just choose your destination in "FindHello &gt; ..." from the top left button in the top bar (to the right of the play button)</p>
<p><img alt="Running app" src="../../img/Screenshot%202019-02-12%20at%2012.56.42.png" /></p>
<p>Alternatively, you can try to use the <code>ionic cordova run ios</code> and <code>ionic cordova emulate ios</code> to skip Xcode, but I find this approach to be buggy and unreliable. Like Android, you can also add the <code>-lc</code> flag to try get real time live reloads, but it's also buggy.</p>
<h3 id="sharing-builds">Sharing builds</h3>
<p>Unlike Android, you can't simply share a build once you've built it locally. Instead, Apple require you to create an "archive" (this is the equivilant of the Android "APK"). </p>
<p>Then there are two approaches to sharing builds for testing:</p>
<h4 id="over-the-air">Over the air</h4>
<p>You generate an archive and upload it to a server you control. You then set up a simple web page that can be reached from your web browser on your iOSdevice (has to be Safari). This web page tells Safari where to download the archive. Safari automatically handles this process. <strong>We're not using this approach as it's complicated and buggy</strong></p>
<p>See more at <a href="https://help.apple.com/deployment/ios/#/apda0e3426d7">https://help.apple.com/deployment/ios/#/apda0e3426d7</a></p>
<h4 id="test-flight">Test Flight</h4>
<p>This is an application you can download onto your iOS device that allows you to receive test builds of an application. This requires your App Store Connect account is set up.</p>
<p>See more at <a href="https://blog.ionicframework.com/using-testflight-for-user-testing-with-ionic/">https://blog.ionicframework.com/using-testflight-for-user-testing-with-ionic/</a></p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/usahello/usahello-docs" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
